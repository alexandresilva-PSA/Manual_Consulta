<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual do Usuário — Consulta EFD Contribuições v1.0</title>
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M8 28L20 16L32 28' stroke='%2384CC16' stroke-width='4' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3Cpath d='M8 20L20 8L32 20' stroke='%2314B8A6' stroke-width='4' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3C/svg%3E">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <style>
        :root {
            --teal-500: #14B8A6;
            --teal-600: #0D9488;
            --teal-700: #0F766E;
            --lime-400: #A3E635;
            --lime-500: #84CC16;
            --lime-600: #65A30D;
            --gray-50: #F9FAFB;
            --gray-100: #F3F4F6;
            --gray-200: #E5E7EB;
            --gray-400: #9CA3AF;
            --gray-500: #6B7280;
            --gray-600: #4B5563;
            --gray-700: #374151;
            --gray-800: #1F2937;
            --gray-900: #111827;
            --red-500: #EF4444;
            --amber-500: #F59E0B;
            --amber-100: #FEF3C7;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Work Sans', sans-serif;
            font-size: 16px;
            line-height: 1.7;
            color: var(--gray-700);
            background-color: var(--gray-100);
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* HEADER */
        .header {
            background-color: var(--gray-900);
            padding: 0 1.5rem;
            height: 72px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            height: 48px;
            width: auto;
        }

        .header-divider {
            width: 1px;
            height: 28px;
            background-color: var(--gray-600);
            margin: 0 0.5rem;
        }

        .header-title {
            color: var(--gray-200);
            font-size: 1rem;
            font-weight: 400;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .badge-versao {
            background-color: rgba(20, 184, 166, 0.15);
            color: var(--teal-500);
            border: 1px solid rgba(20, 184, 166, 0.3);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* LAYOUT */
        .layout {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* SIDEBAR */
        .sidebar {
            width: 280px;
            background-color: #fff;
            border-right: 1px solid var(--gray-200);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            flex-shrink: 0;
            transition: margin-left 0.3s ease;
            z-index: 90;
        }

        .sidebar.collapsed {
            margin-left: -280px;
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-100);
        }

        .sidebar-header h2 {
            font-size: 0.6875rem;
            font-weight: 700;
            color: var(--gray-400);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .sidebar-nav {
            padding: 1rem;
            flex: 1;
        }

        /* NAV ACCORDION */
        .nav-group {
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .nav-group-header {
            background-color: var(--gray-50);
            padding: 0.75rem 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--gray-800);
            transition: background 0.2s;
        }

        .nav-group-header:hover {
            background-color: var(--gray-100);
        }

        .nav-group-header .material-icons-round {
            color: var(--gray-500);
            transition: transform 0.3s;
        }

        .nav-group.collapsed .nav-group-header .material-icons-round {
            transform: rotate(-90deg);
        }

        .nav-group-content {
            display: block;
            border-top: 1px solid var(--gray-200);
        }

        .nav-group.collapsed .nav-group-content {
            display: none;
        }

        .sidebar-nav a {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            text-decoration: none;
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--gray-600);
            border-left: 3px solid transparent;
            white-space: normal;
            line-height: 1.4;
            transition: all 0.2s;
        }

        .sidebar-nav a:hover {
            background-color: var(--gray-50);
            color: var(--teal-600);
        }

        .sidebar-nav a.active {
            background-color: rgba(20, 184, 166, 0.1);
            border-left-color: var(--teal-500);
            color: var(--teal-700);
        }

        /* MAIN CONTENT */
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 2rem 3rem;
            background-color: var(--gray-50);
            scroll-behavior: smooth;
        }

        .content-wrapper {
            max-width: 900px;
            margin: 0 auto;
            padding-bottom: 100px;
        }

        /* SEÇÕES */
        .secao {
            background-color: #fff;
            border-radius: 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            margin-bottom: 2rem;
            overflow: hidden;
            position: relative;
            scroll-margin-top: 90px;
        }

        .secao-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--gray-100);
        }

        .secao-numero {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgba(20, 184, 166, 0.1);
            color: var(--teal-600);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.125rem;
            flex-shrink: 0;
        }

        .secao-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-800);
            flex: 1;
        }

        .secao-conteudo {
            padding: 2rem;
        }

        .secao-conteudo h3 {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--gray-800);
            margin: 2rem 0 0.75rem 0;
        }

        .secao-conteudo h3:first-child {
            margin-top: 0;
        }

        .secao-conteudo p {
            margin-bottom: 1rem;
            color: var(--gray-600);
        }

        .secao-conteudo strong {
            color: var(--teal-600);
            font-weight: 600;
        }

        /* IMAGENS */
        .img-container {
            margin: 1.5rem 0;
            text-align: center;
        }

        .img-wrapper {
            position: relative;
            width: 100%;
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--gray-100);
        }

        .img-screenshot {
            display: block;
            width: 100%;
            height: auto;
        }

        .img-caption {
            margin-top: 0.75rem;
            font-size: 0.8125rem;
            font-weight: 400;
            color: var(--gray-500);
            font-style: italic;
        }

        /* DICA / AVISO */
        .dica,
        .aviso {
            display: flex;
            gap: 1rem;
            padding: 1rem 1.25rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .dica {
            background-color: rgba(20, 184, 166, 0.08);
            border-left: 4px solid var(--teal-500);
        }

        .dica .material-icons-round {
            color: var(--teal-500);
            flex-shrink: 0;
        }

        .dica p {
            color: var(--teal-700);
            margin: 0;
            font-size: 0.9375rem;
        }

        .aviso {
            background-color: var(--amber-100);
            border-left: 4px solid var(--amber-500);
        }

        .aviso .material-icons-round {
            color: var(--amber-500);
            flex-shrink: 0;
        }

        .aviso p {
            color: var(--gray-700);
            margin: 0;
            font-size: 0.9375rem;
        }

        /* LISTA */
        .lista-dicas {
            list-style: none;
            padding: 0;
        }

        .lista-dicas li {
            position: relative;
            padding: 0.75rem 0 0.75rem 2rem;
            border-bottom: 1px solid var(--gray-100);
        }

        .lista-dicas li:last-child {
            border-bottom: none;
        }

        .lista-dicas li::before {
            content: "✓";
            position: absolute;
            left: 0;
            color: var(--teal-500);
            font-weight: 700;
        }

        /* TABELA */
        .tabela-info {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            font-size: 0.9375rem;
        }

        .tabela-info th,
        .tabela-info td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--gray-200);
        }

        .tabela-info th {
            background-color: var(--gray-50);
            font-weight: 600;
            color: var(--gray-700);
        }

        .tabela-info td {
            color: var(--gray-600);
        }

        .tabela-info code {
            background-color: var(--gray-100);
            padding: 0.125rem 0.5rem;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.8125rem;
            color: var(--teal-700);
        }

        /* TOGGLE SIDEBAR */
        .btn-toggle-sidebar {
            background: none;
            border: none;
            color: var(--gray-400);
            padding: 0.5rem;
            cursor: pointer;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-toggle-sidebar:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        /* ADICIONADO PARA EDIÇÃO */
        .btn-salvar {
            background-color: var(--teal-500);
            color: #fff;
        }

        .btn-salvar:hover {
            background-color: var(--teal-600);
        }

        .btn-exportar {
            background-color: var(--lime-500);
            color: #fff;
        }

        .btn-exportar:hover {
            background-color: var(--lime-600);
        }

        .btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.8125rem;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }

        .admin-only {}

        .floating-toolbar {
            position: absolute;
            bottom: 16px;
            right: 16px;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid var(--gray-200);
            border-radius: 50px;
            padding: 4px;
            display: flex;
            align-items: center;
            gap: 4px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 20;
        }

        .btn-float {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: transparent;
            color: var(--gray-600);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.2s;
        }

        .btn-float:hover {
            background-color: var(--gray-100);
            color: var(--gray-900);
        }

        .btn-mark-float {
            padding: 0 12px 0 8px;
            width: auto;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--teal-600);
            background-color: rgba(20, 184, 166, 0.1);
        }

        .divider-vertical {
            width: 1px;
            height: 20px;
            background: var(--gray-300);
            margin: 0 2px;
        }

        .marker {
            position: absolute;
            width: 50px;
            height: 50px;
            border: 3px solid var(--red-500);
            border-radius: 50%;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.4);
            cursor: move;
            z-index: 10;
        }

        .marker-resize-handle {
            position: absolute;
            bottom: -6px;
            right: -6px;
            width: 14px;
            height: 14px;
            background-color: var(--red-500);
            border: 2px solid #fff;
            border-radius: 50%;
            cursor: nwse-resize;
            z-index: 12;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .marker:hover .marker-resize-handle {
            opacity: 1;
        }

        .marker-delete-btn {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 20px;
            height: 20px;
            background-color: var(--red-500);
            color: white;
            border-radius: 50%;
            border: 2px solid #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            z-index: 12;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .marker:hover .marker-delete-btn {
            opacity: 1;
        }

        .fab-add {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--teal-500);
            color: white;
            border: none;
            box-shadow: 0 6px 20px rgba(20, 184, 166, 0.4);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            transition: transform 0.2s;
        }

        .fab-add:hover {
            transform: scale(1.1);
            background-color: var(--teal-600);
        }

        .btn-delete-section {
            background: none;
            border: none;
            color: var(--gray-400);
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
        }

        .btn-delete-section:hover {
            color: var(--red-500);
            background: #FEF2F2;
        }

        .img-viewport {
            width: 100%;
            cursor: default;
            transform-origin: 0 0;
        }

        .img-viewport.grabbing {
            cursor: grabbing;
        }

        .img-viewport.grab {
            cursor: grab;
        }

        body.mode-read-only .marker,
        body.mode-read-only .img-viewport {
            cursor: default !important;
        }

        body.mode-read-only .marker-delete-btn,
        body.mode-read-only .marker-resize-handle {
            display: none;
        }

        [contenteditable]:focus {
            outline: none;
            background-color: rgba(20, 184, 166, 0.05);
            border-radius: 4px;
        }
    </style>
</head>

<body>
    <!-- HEADER -->
    <header class="header">
        <div class="header-left">
            <svg class="logo" viewBox="0 0 180 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M8 38L20 26L32 38" stroke="#84CC16" stroke-width="4" stroke-linecap="round"
                    stroke-linejoin="round" />
                <path d="M8 28L20 16L32 28" stroke="#14B8A6" stroke-width="4" stroke-linecap="round"
                    stroke-linejoin="round" />
                <text x="44" y="34" fill="#E5E7EB" font-family="Work Sans" font-weight="700" font-size="22">PSA</text>
                <text x="90" y="34" fill="#9CA3AF" font-family="Work Sans" font-weight="400"
                    font-size="22">Consultores</text>
            </svg>
            <div class="header-divider"></div>
            <span class="header-title">Manual do Usuário</span>
        </div>
        <div class="header-right">
            <span class="badge-versao" contenteditable="true">EFD Contribuições v1.0</span>
            <div class="header-buttons admin-only" style="display:flex; gap:0.5rem; margin-right: 1rem;">
                <button class="btn btn-salvar" onclick="salvarAlteracoes()">
                    <span class="material-icons-round">save</span>
                    <span>Salvar</span>
                </button>
                <button class="btn btn-exportar" onclick="exportarHTML()">
                    <span class="material-icons-round">visibility</span>
                    <span>Exportar</span>
                </button>
            </div>
            <button class="btn-toggle-sidebar" onclick="toggleSidebar()">
                <span class="material-icons-round">menu</span>
            </button>
        </div>
    </header>

    <div class="layout">
        <!-- SIDEBAR -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>Sumário</h2>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-group">
                    <div class="nav-group-header" onclick="toggleNavGroup(this)">
                        Introdução
                        <span class="material-icons-round">expand_more</span>
                    </div>
                    <div class="nav-group-content">
                        <a href="#secao-1">1. Visão Geral</a>
                        <a href="#secao-2">2. Acesso ao Sistema</a>
                    </div>
                </div>
                <div class="nav-group">
                    <div class="nav-group-header" onclick="toggleNavGroup(this)">
                        Consulta de Arquivos
                        <span class="material-icons-round">expand_more</span>
                    </div>
                    <div class="nav-group-content">
                        <a href="#secao-3">3. Filtros de Busca</a>
                        <a href="#secao-4">4. Lista de Arquivos</a>
                        <a href="#secao-5">5. Download de Arquivos</a>
                    </div>
                </div>
                <div class="nav-group">
                    <div class="nav-group-header" onclick="toggleNavGroup(this)">
                        Exportação Excel
                        <span class="material-icons-round">expand_more</span>
                    </div>
                    <div class="nav-group-content">
                        <a href="#secao-6">6. Modal de Exportação</a>
                        <a href="#secao-7">7. Seleção de Registros</a>
                        <a href="#secao-8">8. Perfis de Exportação</a>
                        <a href="#secao-9">9. Gerando o Relatório</a>
                    </div>
                </div>
                <div class="nav-group">
                    <div class="nav-group-header" onclick="toggleNavGroup(this)">
                        Análise de Arquivos
                        <span class="material-icons-round">expand_more</span>
                    </div>
                    <div class="nav-group-content">
                        <a href="#secao-10">10. Modal de Análise</a>
                        <a href="#secao-11">11. Navegação por Blocos</a>
                        <a href="#secao-12">12. Visualização de Dados</a>
                    </div>
                </div>
                <div class="nav-group">
                    <div class="nav-group-header" onclick="toggleNavGroup(this)">
                        Referência
                        <span class="material-icons-round">expand_more</span>
                    </div>
                    <div class="nav-group-content">
                        <a href="#secao-13">13. Estrutura dos Blocos</a>
                        <a href="#secao-14">14. Dicas e Boas Práticas</a>
                    </div>
                </div>
            </nav>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <div class="content-wrapper">

                <!-- SEÇÃO 1: VISÃO GERAL -->
                <section class="secao" id="secao-1">
                    <div class="secao-header">
                        <span class="secao-numero">1</span>
                        <h2>Visão Geral</h2>
                    </div>
                    <div class="secao-conteudo">
                        <h3>1.1 O que é a Consulta EFD Contribuições?</h3>
                        <p>A ferramenta <strong>Consulta EFD Contribuições</strong> permite visualizar, analisar e
                            exportar arquivos SPED EFD Contribuições (PIS/COFINS) dos clientes cadastrados no sistema.
                        </p>
                        <p>Com esta ferramenta, você pode filtrar arquivos por cliente, contribuinte e período, realizar
                            downloads individuais ou em lote, exportar dados para Excel com seleção personalizada de
                            registros e analisar o conteúdo detalhado de cada arquivo.</p>

                        <h3>1.2 Principais Funcionalidades</h3>
                        <p>A ferramenta oferece três funcionalidades principais:</p>
                        <table class="tabela-info">
                            <tr>
                                <th>Funcionalidade</th>
                                <th>Descrição</th>
                            </tr>
                            <tr>
                                <td><strong>Download</strong></td>
                                <td>Baixar arquivos TXT originais, individualmente ou em lote (ZIP)</td>
                            </tr>
                            <tr>
                                <td><strong>Exportar Excel</strong></td>
                                <td>Gerar relatório Excel com registros selecionados e perfis salvos</td>
                            </tr>
                            <tr>
                                <td><strong>Analisar</strong></td>
                                <td>Visualizar dados estruturados por bloco e registro SPED</td>
                            </tr>
                        </table>
                    </div>
                </section>

                <!-- SEÇÃO 2: ACESSO AO SISTEMA -->
                <section class="secao" id="secao-2">
                    <div class="secao-header">
                        <span class="secao-numero">2</span>
                        <h2>Acesso ao Sistema</h2>
                    </div>
                    <div class="secao-conteudo">
                        <h3>2.1 Acessando a Área da Equipe</h3>
                        <p>Acesse o site da <strong>PSA Consultores</strong> e clique em <strong>Área da Equipe</strong>
                            no menu superior.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/01-01-homepage-psa.png" class="img-screenshot"
                                    alt="Homepage PSA Consultores">
                            </div>
                            <p class="img-caption">Homepage PSA Consultores com menu de navegação</p>
                        </div>

                        <h3>2.2 Selecionando a Área</h3>
                        <p>No dropdown de áreas, selecione <strong>Digital</strong> para acessar as ferramentas do setor
                            Digital.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/01-04-area-equipe-dropdown.png" class="img-screenshot"
                                    alt="Dropdown de áreas">
                            </div>
                            <p class="img-caption">Seleção da área Digital no dropdown</p>
                        </div>

                        <h3>2.3 Realizando Login</h3>
                        <p>Na tela de login, informe seu <strong>E-mail</strong> e <strong>Senha</strong> corporativos e
                            clique em <strong>Entrar</strong>.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/01-05-tela-login.png" class="img-screenshot" alt="Tela de login">
                            </div>
                            <p class="img-caption">Tela de login da área Digital</p>
                        </div>

                        <h3>2.4 Navegando até a Ferramenta</h3>
                        <p>Após o login, selecione <strong>Digital Dev</strong> e, no menu lateral, clique em
                            <strong>EFD Contribuições</strong>.
                        </p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/01-08-dashboard-dev.png" class="img-screenshot" alt="Dashboard Dev">
                            </div>
                            <p class="img-caption">Dashboard Digital Dev com menu de ferramentas</p>
                        </div>
                    </div>
                </section>

                <!-- SEÇÃO 3: FILTROS DE BUSCA -->
                <section class="secao" id="secao-3">
                    <div class="secao-header">
                        <span class="secao-numero">3</span>
                        <h2>Filtros de Busca</h2>
                    </div>
                    <div class="secao-conteudo">
                        <h3>3.1 Tela Inicial</h3>
                        <p>A tela de <strong>Consulta EFD Contribuições</strong> apresenta quatro filtros para localizar
                            arquivos.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/02-01-filtros-vazio.png" class="img-screenshot" alt="Filtros vazios">
                            </div>
                            <p class="img-caption">Tela inicial com filtros de busca</p>
                        </div>

                        <h3>3.2 Selecionando o Cliente</h3>
                        <p>Clique no campo <strong>Cliente</strong> para abrir o dropdown e selecione o cliente
                            desejado.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/02-02-dropdown-cliente.png" class="img-screenshot"
                                    alt="Dropdown de clientes">
                            </div>
                            <p class="img-caption">Lista de clientes disponíveis</p>
                        </div>

                        <h3>3.3 Selecionando o Contribuinte</h3>
                        <p>Após selecionar o cliente, o campo <strong>Contribuinte</strong> é habilitado. Selecione o
                            CNPJ do contribuinte.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/02-03-dropdown-contribuinte.png" class="img-screenshot"
                                    alt="Dropdown de contribuintes">
                            </div>
                            <p class="img-caption">Seleção do contribuinte (CNPJ)</p>
                        </div>

                        <h3>3.4 Definindo o Período</h3>
                        <p>Utilize os campos <strong>Data de Início</strong> e <strong>Data Fim</strong> para definir o
                            período de busca. O calendário exibe os meses do ano selecionado.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/02-05-calendario-2026.png" class="img-screenshot"
                                    alt="Calendário mensal">
                            </div>
                            <p class="img-caption">Calendário para seleção de mês/ano</p>
                        </div>

                        <h3>3.5 Executando a Busca</h3>
                        <p>Com os filtros preenchidos, clique em <strong>Buscar Arquivos</strong> para listar os
                            arquivos encontrados.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/02-06-filtros-preenchidos.png" class="img-screenshot"
                                    alt="Filtros preenchidos">
                            </div>
                            <p class="img-caption">Filtros preenchidos prontos para busca</p>
                        </div>

                        <div class="dica">
                            <span class="material-icons-round">lightbulb</span>
                            <p>Utilize o botão <strong>Limpar Filtros</strong> para resetar todos os campos e iniciar
                                uma nova busca.</p>
                        </div>
                    </div>
                </section>

                <!-- SEÇÃO 4: LISTA DE ARQUIVOS -->
                <section class="secao" id="secao-4">
                    <div class="secao-header">
                        <span class="secao-numero">4</span>
                        <h2>Lista de Arquivos</h2>
                    </div>
                    <div class="secao-conteudo">
                        <h3>4.1 Tabela de Resultados</h3>
                        <p>Os arquivos encontrados são exibidos em uma tabela com as colunas: <strong>Arquivo</strong>,
                            <strong>Período</strong>, <strong>Tipo</strong>, <strong>Crédito PIS</strong>,
                            <strong>Crédito COFINS</strong> e <strong>Ações</strong>.
                        </p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/03-01-lista-arquivos.png" class="img-screenshot"
                                    alt="Lista de arquivos">
                            </div>
                            <p class="img-caption">Tabela com arquivos EFD Contribuições</p>
                        </div>

                        <h3>4.2 Informações da Tabela</h3>
                        <table class="tabela-info">
                            <tr>
                                <th>Coluna</th>
                                <th>Descrição</th>
                            </tr>
                            <tr>
                                <td><strong>Arquivo</strong></td>
                                <td>Nome do contribuinte e ID único do arquivo</td>
                            </tr>
                            <tr>
                                <td><strong>Período</strong></td>
                                <td>Data de início e fim da escrituração</td>
                            </tr>
                            <tr>
                                <td><strong>Tipo</strong></td>
                                <td><code>ORIGINAL</code> ou <code>RETIFICADORA</code></td>
                            </tr>
                            <tr>
                                <td><strong>Crédito PIS</strong></td>
                                <td>Valor total de créditos de PIS no período</td>
                            </tr>
                            <tr>
                                <td><strong>Crédito COFINS</strong></td>
                                <td>Valor total de créditos de COFINS no período</td>
                            </tr>
                            <tr>
                                <td><strong>Ações</strong></td>
                                <td>Botões para download, exportação e análise</td>
                            </tr>
                        </table>

                        <div class="aviso">
                            <span class="material-icons-round">info</span>
                            <p>Arquivos do tipo <strong>RETIFICADORA</strong> substituem o arquivo original do mesmo
                                período. Verifique sempre qual versão deve ser utilizada.</p>
                        </div>
                    </div>
                </section>

                <!-- SEÇÃO 5: DOWNLOAD DE ARQUIVOS -->
                <section class="secao" id="secao-5">
                    <div class="secao-header">
                        <span class="secao-numero">5</span>
                        <h2>Download de Arquivos</h2>
                    </div>
                    <div class="secao-conteudo">
                        <h3>5.1 Download Individual</h3>
                        <p>Para baixar um arquivo específico, clique no ícone de <strong>download</strong> na coluna
                            Ações. O tooltip indica "Baixar Original (TXT)".</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/03-02-tooltip-baixar-txt.png" class="img-screenshot"
                                    alt="Tooltip download">
                            </div>
                            <p class="img-caption">Ícone de download com tooltip</p>
                        </div>

                        <h3>5.2 Notificação de Download</h3>
                        <p>Ao iniciar o download, uma notificação (toast) é exibida confirmando o sucesso da operação.
                        </p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/03-03-toast-download-iniciado.png" class="img-screenshot"
                                    alt="Toast download">
                            </div>
                            <p class="img-caption">Notificação de download concluído</p>
                        </div>

                        <h3>5.3 Download em Lote</h3>
                        <p>Para baixar todos os arquivos listados, clique no botão <strong>Baixar Todos</strong> no
                            canto superior direito.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/03-04-tooltip-baixar-todos.png" class="img-screenshot"
                                    alt="Botão Baixar Todos">
                            </div>
                            <p class="img-caption">Botão Baixar Todos com tooltip</p>
                        </div>

                        <h3>5.4 Arquivo ZIP</h3>
                        <p>O sistema gera um arquivo <strong>ZIP</strong> contendo todos os arquivos TXT. A notificação
                            exibe o nome e tamanho do arquivo.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/03-06-toast-download-zip.png" class="img-screenshot"
                                    alt="Toast download ZIP">
                            </div>
                            <p class="img-caption">Download do arquivo ZIP concluído</p>
                        </div>

                        <div class="dica">
                            <span class="material-icons-round">lightbulb</span>
                            <p>O nome do arquivo ZIP segue o padrão: <code>efd_contribuicoes_DDMMAAAAHHMISS.zip</code>
                            </p>
                        </div>
                    </div>
                </section>

                <!-- SEÇÃO 6: MODAL DE EXPORTAÇÃO -->
                <section class="secao" id="secao-6">
                    <div class="secao-header">
                        <span class="secao-numero">6</span>
                        <h2>Modal de Exportação</h2>
                    </div>
                    <div class="secao-conteudo">
                        <h3>6.1 Abrindo o Modal</h3>
                        <p>Clique no ícone <strong>Exportar Excel</strong> na coluna Ações para abrir o modal de
                            exportação.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/04-01-tooltip-exportar-excel.png" class="img-screenshot"
                                    alt="Tooltip Exportar Excel">
                            </div>
                            <p class="img-caption">Ícone Exportar Excel com tooltip</p>
                        </div>

                        <h3>6.2 Estrutura do Modal</h3>
                        <p>O modal <strong>Exportar para Excel</strong> permite selecionar quais registros SPED serão
                            incluídos no relatório.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/04-02-modal-exportar-inicial.png" class="img-screenshot"
                                    alt="Modal Exportar Excel">
                            </div>
                            <p class="img-caption">Modal de exportação com blocos de registros</p>
                        </div>

                        <h3>6.3 Componentes do Modal</h3>
                        <table class="tabela-info">
                            <tr>
                                <th>Componente</th>
                                <th>Função</th>
                            </tr>
                            <tr>
                                <td><strong>Carregar Perfil</strong></td>
                                <td>Dropdown para selecionar perfis salvos</td>
                            </tr>
                            <tr>
                                <td><strong>Botão +</strong></td>
                                <td>Salvar a seleção atual como novo perfil</td>
                            </tr>
                            <tr>
                                <td><strong>Selecionar Todos</strong></td>
                                <td>Marca todos os registros de todos os blocos</td>
                            </tr>
                            <tr>
                                <td><strong>Limpar</strong></td>
                                <td>Desmarca todos os registros</td>
                            </tr>
                            <tr>
                                <td><strong>Lista de Blocos</strong></td>
                                <td>Blocos SPED com registros selecionáveis</td>
                            </tr>
                            <tr>
                                <td><strong>Gerar Relatório</strong></td>
                                <td>Gera o arquivo Excel com os registros selecionados</td>
                            </tr>
                        </table>
                    </div>
                </section>

                <!-- SEÇÃO 7: SELEÇÃO DE REGISTROS -->
                <section class="secao" id="secao-7">
                    <div class="secao-header">
                        <span class="secao-numero">7</span>
                        <h2>Seleção de Registros</h2>
                    </div>
                    <div class="secao-conteudo">
                        <h3>7.1 Perfil "Todos os Registros"</h3>
                        <p>Selecione <strong>Todos os Registros</strong> no dropdown para marcar automaticamente todos
                            os registros disponíveis.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/04-04-todos-registros-selecionados.png" class="img-screenshot"
                                    alt="Todos registros selecionados">
                            </div>
                            <p class="img-caption">Todos os registros selecionados (38 registros)</p>
                        </div>

                        <h3>7.2 Expandindo um Bloco</h3>
                        <p>Clique no nome do bloco para expandir e visualizar os registros disponíveis. Cada registro
                            pode ser marcado individualmente.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/04-05-bloco0-expandido.png" class="img-screenshot"
                                    alt="Bloco 0 expandido">
                            </div>
                            <p class="img-caption">Bloco 0 - Abertura e Identificação expandido</p>
                        </div>

                        <h3>7.3 Seleção Parcial</h3>
                        <p>É possível selecionar apenas alguns registros de um bloco. O badge indica quantos estão
                            selecionados.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/04-06-bloco0-selecao-parcial.png" class="img-screenshot"
                                    alt="Seleção parcial">
                            </div>
                            <p class="img-caption">Bloco 0 com 7 de 9 registros selecionados</p>
                        </div>

                        <h3>7.4 Blocos Disponíveis</h3>
                        <table class="tabela-info">
                            <tr>
                                <th>Bloco</th>
                                <th>Descrição</th>
                                <th>Registros</th>
                            </tr>
                            <tr>
                                <td><strong>Bloco 0</strong></td>
                                <td>Abertura e Identificação</td>
                                <td>0000, 0001, 0110, 0111, 0140, 0150, 0200, 0500, 0600</td>
                            </tr>
                            <tr>
                                <td><strong>Bloco 1</strong></td>
                                <td>Complementos</td>
                                <td>1001, 1100, 1500</td>
                            </tr>
                            <tr>
                                <td><strong>Bloco A</strong></td>
                                <td>Serviços (ISS)</td>
                                <td>A001, A010, A100, A170</td>
                            </tr>
                            <tr>
                                <td><strong>Bloco C</strong></td>
                                <td>Documentos Fiscais (ICMS/IPI)</td>
                                <td>C001, C010, C100, C170, C500</td>
                            </tr>
                            <tr>
                                <td><strong>Bloco D</strong></td>
                                <td>Documentos Fiscais (Serviços)</td>
                                <td>D001, D010, D100, D101, D105, D500</td>
                            </tr>
                            <tr>
                                <td><strong>Bloco F</strong></td>
                                <td>Demais Documentos</td>
                                <td>F001, F010, F100, F500</td>
                            </tr>
                            <tr>
                                <td><strong>Bloco M</strong></td>
                                <td>Apuração e Créditos</td>
                                <td>M001, M100, M105, M200, M400, M500, M600</td>
                            </tr>
                        </table>
                    </div>
                </section>

                <!-- SEÇÃO 8: PERFIS DE EXPORTAÇÃO -->
                <section class="secao" id="secao-8">
                    <div class="secao-header">
                        <span class="secao-numero">8</span>
                        <h2>Perfis de Exportação</h2>
                    </div>
                    <div class="secao-conteudo">
                        <h3>8.1 Salvando um Perfil</h3>
                        <p>Após configurar a seleção desejada, clique no botão <strong>+</strong> para abrir o modal de
                            salvar perfil.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/05-01-modal-salvar-perfil.png" class="img-screenshot"
                                    alt="Modal salvar perfil">
                            </div>
                            <p class="img-caption">Modal para salvar perfil de exportação</p>
                        </div>

                        <h3>8.2 Nomeando o Perfil</h3>
                        <p>Digite um nome descritivo no campo <strong>Nome do Perfil</strong>. Marque <strong>Definir
                                como perfil padrão</strong> se desejar que ele seja carregado automaticamente.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/05-04-checkbox-perfil-padrao.png" class="img-screenshot"
                                    alt="Checkbox perfil padrão">
                            </div>
                            <p class="img-caption">Opção para definir como perfil padrão</p>
                        </div>

                        <h3>8.3 Confirmação</h3>
                        <p>Clique em <strong>Salvar Perfil</strong>. Uma notificação confirma a criação do perfil.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/05-06-toast-perfil-criado.png" class="img-screenshot"
                                    alt="Toast perfil criado">
                            </div>
                            <p class="img-caption">Notificação de perfil criado com sucesso</p>
                        </div>

                        <h3>8.4 Utilizando Perfis Salvos</h3>
                        <p>Os perfis salvos aparecem no dropdown <strong>Carregar Perfil</strong>. O perfil padrão é
                            indicado por uma <strong>estrela</strong>.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/05-18-dropdown-multiplos-perfis.png" class="img-screenshot"
                                    alt="Dropdown com perfis">
                            </div>
                            <p class="img-caption">Dropdown com perfis salvos (estrela indica padrão)</p>
                        </div>

                        <h3>8.5 Excluindo um Perfil</h3>
                        <p>Para excluir um perfil, passe o mouse sobre ele no dropdown e clique no ícone de
                            <strong>lixeira</strong>. Confirme a exclusão no modal.
                        </p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/05-20-modal-confirmar-exclusao.png" class="img-screenshot"
                                    alt="Modal confirmar exclusão">
                            </div>
                            <p class="img-caption">Modal de confirmação de exclusão de perfil</p>
                        </div>

                        <div class="aviso">
                            <span class="material-icons-round">warning</span>
                            <p>A exclusão de perfis é <strong>permanente</strong> e não pode ser desfeita.</p>
                        </div>
                    </div>
                </section>

                <!-- SEÇÃO 9: GERANDO O RELATÓRIO -->
                <section class="secao" id="secao-9">
                    <div class="secao-header">
                        <span class="secao-numero">9</span>
                        <h2>Gerando o Relatório</h2>
                    </div>
                    <div class="secao-conteudo">
                        <h3>9.1 Iniciando a Exportação</h3>
                        <p>Com os registros selecionados, clique em <strong>Gerar Relatório</strong>. O número entre
                            parênteses indica a quantidade de registros.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/06-01-modal-pronto-exportar.png" class="img-screenshot"
                                    alt="Modal pronto para exportar">
                            </div>
                            <p class="img-caption">34 registros selecionados prontos para exportar</p>
                        </div>

                        <h3>9.2 Processamento</h3>
                        <p>Durante a geração do arquivo, o botão exibe <strong>Processando...</strong> e o status muda
                            para "Exportação em Andamento".</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/06-02-exportacao-processando.png" class="img-screenshot"
                                    alt="Exportação processando">
                            </div>
                            <p class="img-caption">Exportação em andamento</p>
                        </div>

                        <h3>9.3 Download Concluído</h3>
                        <p>Ao finalizar, o arquivo Excel é baixado automaticamente e uma notificação confirma o sucesso.
                        </p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/06-03-toast-exportacao-concluida.png" class="img-screenshot"
                                    alt="Toast exportação concluída">
                            </div>
                            <p class="img-caption">Notificação de exportação concluída com sucesso</p>
                        </div>

                        <div class="dica">
                            <span class="material-icons-round">lightbulb</span>
                            <p>O arquivo Excel é gerado com uma aba para cada tipo de registro selecionado, facilitando
                                a análise dos dados.</p>
                        </div>
                    </div>
                </section>

                <!-- SEÇÃO 10: MODAL DE ANÁLISE -->
                <section class="secao" id="secao-10">
                    <div class="secao-header">
                        <span class="secao-numero">10</span>
                        <h2>Modal de Análise</h2>
                    </div>
                    <div class="secao-conteudo">
                        <h3>10.1 Abrindo a Análise</h3>
                        <p>Clique no botão <strong>Analisar</strong> na coluna Ações para abrir o modal de análise
                            detalhada do arquivo.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/07-01-lista-pre-analise.png" class="img-screenshot"
                                    alt="Lista pré-análise">
                            </div>
                            <p class="img-caption">Botão Analisar na lista de arquivos</p>
                        </div>

                        <h3>10.2 Estrutura do Modal</h3>
                        <p>O modal de análise exibe um cabeçalho com informações do arquivo e uma barra lateral para
                            navegação entre blocos.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/07-03-modal-analise-inicial.png" class="img-screenshot"
                                    alt="Modal de análise">
                            </div>
                            <p class="img-caption">Modal de análise com sidebar de navegação</p>
                        </div>

                        <h3>10.3 Cabeçalho do Modal</h3>
                        <p>O cabeçalho exibe: nome do contribuinte, tipo do arquivo (ORIGINAL/RETIFICADORA), período e
                            totais de PIS/COFINS.</p>
                        <table class="tabela-info">
                            <tr>
                                <th>Informação</th>
                                <th>Descrição</th>
                            </tr>
                            <tr>
                                <td><strong>Contribuinte</strong></td>
                                <td>Razão social da empresa</td>
                            </tr>
                            <tr>
                                <td><strong>Badge</strong></td>
                                <td>ORIGINAL ou RETIFICADORA</td>
                            </tr>
                            <tr>
                                <td><strong>Período</strong></td>
                                <td>Data inicial e final da escrituração</td>
                            </tr>
                            <tr>
                                <td><strong>Total PIS</strong></td>
                                <td>Valor total de créditos PIS</td>
                            </tr>
                            <tr>
                                <td><strong>Total COFINS</strong></td>
                                <td>Valor total de créditos COFINS</td>
                            </tr>
                        </table>
                    </div>
                </section>

                <!-- SEÇÃO 11: NAVEGAÇÃO POR BLOCOS -->
                <section class="secao" id="secao-11">
                    <div class="secao-header">
                        <span class="secao-numero">11</span>
                        <h2>Navegação por Blocos</h2>
                    </div>
                    <div class="secao-conteudo">
                        <h3>11.1 Sidebar de Blocos</h3>
                        <p>A barra lateral exibe todos os blocos SPED disponíveis no arquivo. Clique em um bloco para
                            expandir seus registros.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/07-04-sidebar-bloco0-expandido.png" class="img-screenshot"
                                    alt="Sidebar Bloco 0">
                            </div>
                            <p class="img-caption">Bloco 0 expandido na sidebar</p>
                        </div>

                        <h3>11.2 Registros do Bloco</h3>
                        <p>Ao expandir um bloco, são exibidos os registros disponíveis. Clique em um registro para
                            visualizar seus dados na área principal.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/07-05-sidebar-blocoC-expandido.png" class="img-screenshot"
                                    alt="Sidebar Bloco C">
                            </div>
                            <p class="img-caption">Bloco C - Documentos Fiscais expandido</p>
                        </div>

                        <h3>11.3 Múltiplos Blocos</h3>
                        <p>É possível ter múltiplos blocos expandidos simultaneamente para facilitar a navegação.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/07-12-sidebar-todos-blocos.png" class="img-screenshot"
                                    alt="Todos os blocos">
                            </div>
                            <p class="img-caption">Sidebar com múltiplos blocos visíveis</p>
                        </div>
                    </div>
                </section>

                <!-- SEÇÃO 12: VISUALIZAÇÃO DE DADOS -->
                <section class="secao" id="secao-12">
                    <div class="secao-header">
                        <span class="secao-numero">12</span>
                        <h2>Visualização de Dados</h2>
                    </div>
                    <div class="secao-conteudo">
                        <h3>12.1 Tabela de Dados</h3>
                        <p>Ao selecionar um registro, os dados são exibidos em formato de tabela com as colunas
                            correspondentes ao layout SPED.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/07-07-tabela-c170-dados.png" class="img-screenshot" alt="Tabela C170">
                            </div>
                            <p class="img-caption">Registro C170 - Itens do Documento</p>
                        </div>

                        <h3>12.2 Navegação Horizontal</h3>
                        <p>Tabelas com muitas colunas possuem scroll horizontal. Arraste a barra de rolagem para
                            visualizar todas as colunas.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/07-08-tabela-scroll-horizontal.png" class="img-screenshot"
                                    alt="Scroll horizontal">
                            </div>
                            <p class="img-caption">Tabela com scroll horizontal (colunas PIS visíveis)</p>
                        </div>

                        <h3>12.3 Seleção de Dados</h3>
                        <p>Clique em uma célula ou linha para selecioná-la. Os dados selecionados são destacados
                            visualmente.</p>
                        <div class="img-container">
                            <div class="img-wrapper">
                                <img src="imagens/07-11-tabela-linha-selecionada.png" class="img-screenshot"
                                    alt="Linha selecionada">
                            </div>
                            <p class="img-caption">Linha selecionada com destaque visual</p>
                        </div>

                        <h3>12.4 Paginação</h3>
                        <p>Registros com grande volume de dados possuem paginação. O rodapé exibe o total de registros e
                            a página atual.</p>

                        <h3>12.5 Fechando o Modal</h3>
                        <p>Clique no botão <strong>X</strong> no canto superior direito ou pressione
                            <strong>ESC</strong> para fechar o modal.
                        </p>
                    </div>
                </section>

                <!-- SEÇÃO 13: ESTRUTURA DOS BLOCOS -->
                <section class="secao" id="secao-13">
                    <div class="secao-header">
                        <span class="secao-numero">13</span>
                        <h2>Estrutura dos Blocos</h2>
                    </div>
                    <div class="secao-conteudo">
                        <h3>13.1 Bloco 0 - Abertura e Identificação</h3>
                        <p>Contém informações cadastrais do contribuinte, estabelecimentos, participantes e itens.</p>
                        <table class="tabela-info">
                            <tr>
                                <th>Registro</th>
                                <th>Descrição</th>
                            </tr>
                            <tr>
                                <td><code>0000</code></td>
                                <td>Abertura do Arquivo Digital</td>
                            </tr>
                            <tr>
                                <td><code>0001</code></td>
                                <td>Registro SPED</td>
                            </tr>
                            <tr>
                                <td><code>0110</code></td>
                                <td>Regimes de Apuração</td>
                            </tr>
                            <tr>
                                <td><code>0111</code></td>
                                <td>Receita Bruta para Rateio</td>
                            </tr>
                            <tr>
                                <td><code>0140</code></td>
                                <td>Cadastro de Estabelecimento</td>
                            </tr>
                            <tr>
                                <td><code>0150</code></td>
                                <td>Cadastro de Participantes</td>
                            </tr>
                            <tr>
                                <td><code>0200</code></td>
                                <td>Cadastro de Itens</td>
                            </tr>
                            <tr>
                                <td><code>0500</code></td>
                                <td>Conta Contábil</td>
                            </tr>
                            <tr>
                                <td><code>0600</code></td>
                                <td>Centro de Custos</td>
                            </tr>
                        </table>

                        <h3>13.2 Bloco C - Documentos Fiscais (ICMS/IPI)</h3>
                        <p>Contém informações de notas fiscais de mercadorias e produtos.</p>
                        <table class="tabela-info">
                            <tr>
                                <th>Registro</th>
                                <th>Descrição</th>
                            </tr>
                            <tr>
                                <td><code>C001</code></td>
                                <td>Abertura do Bloco C</td>
                            </tr>
                            <tr>
                                <td><code>C010</code></td>
                                <td>Identificação do Estabelecimento</td>
                            </tr>
                            <tr>
                                <td><code>C100</code></td>
                                <td>Nota Fiscal (NF-e, NF)</td>
                            </tr>
                            <tr>
                                <td><code>C170</code></td>
                                <td>Itens do Documento</td>
                            </tr>
                            <tr>
                                <td><code>C500</code></td>
                                <td>Nota Fiscal/Conta de Energia</td>
                            </tr>
                        </table>

                        <h3>13.3 Bloco M - Apuração e Créditos</h3>
                        <p>Contém informações de apuração das contribuições e demonstração dos créditos.</p>
                        <table class="tabela-info">
                            <tr>
                                <th>Registro</th>
                                <th>Descrição</th>
                            </tr>
                            <tr>
                                <td><code>M100</code></td>
                                <td>Crédito de PIS/PASEP do Período</td>
                            </tr>
                            <tr>
                                <td><code>M105</code></td>
                                <td>Detalhamento Base de Cálculo PIS</td>
                            </tr>
                            <tr>
                                <td><code>M200</code></td>
                                <td>Contribuição PIS/PASEP do Período</td>
                            </tr>
                            <tr>
                                <td><code>M500</code></td>
                                <td>Crédito de COFINS do Período</td>
                            </tr>
                            <tr>
                                <td><code>M600</code></td>
                                <td>Contribuição COFINS do Período</td>
                            </tr>
                        </table>
                    </div>
                </section>

                <!-- SEÇÃO 14: DICAS E BOAS PRÁTICAS -->
                <section class="secao" id="secao-14">
                    <div class="secao-header">
                        <span class="secao-numero">14</span>
                        <h2>Dicas e Boas Práticas</h2>
                    </div>
                    <div class="secao-conteudo">
                        <ul class="lista-dicas">
                            <li>Utilize filtros específicos de período para otimizar o tempo de busca e reduzir a
                                quantidade de resultados.</li>
                            <li>Crie perfis de exportação para configurações que você utiliza frequentemente, como
                                "Auditoria Completa" ou "Apenas Créditos".</li>
                            <li>Defina um perfil como padrão para que ele seja carregado automaticamente ao abrir o
                                modal de exportação.</li>
                            <li>Ao exportar grandes volumes de dados, selecione apenas os registros necessários para
                                reduzir o tamanho do arquivo.</li>
                            <li>Verifique sempre se o arquivo é ORIGINAL ou RETIFICADORA antes de utilizar os dados em
                                relatórios.</li>
                            <li>Utilize o modal de análise para validar os dados antes de exportar para Excel.</li>
                            <li>O registro C170 (Itens do Documento) geralmente contém o maior volume de dados - planeje
                                a exportação adequadamente.</li>
                            <li>Mantenha seus perfis de exportação organizados e exclua aqueles que não são mais
                                utilizados.</li>
                        </ul>
                    </div>
                </section>

            </div>
        </main>
    </div>

    <!-- FAB -->
    <button class="fab-add admin-only" onclick="adicionarSecao()"><span class="material-icons-round"
            style="font-size: 32px;">add</span></button>

    <script>
        // --- 1. INICIALIZAÇÃO ---
        window.onload = function () {
            initAdminMode();
            initSystem();
        };

        function initAdminMode() {
            // Se for modo leitura, não faz nada
            if (document.body.classList.contains('mode-read-only')) return;

            // 1. Torna títulos e textos editáveis
            document.querySelectorAll('h1, h2, h3, p, .header-title, li').forEach(el => {
                el.setAttribute('contenteditable', 'true');
            });

            // 2. Prepara seções (adiciona botão delete)
            document.querySelectorAll('.secao-header').forEach(header => {
                if (!header.querySelector('.btn-delete-section')) {
                    const btn = document.createElement('button');
                    btn.className = 'btn-delete-section admin-only';
                    btn.onclick = () => deletarSecao(btn);
                    btn.innerHTML = '<span class="material-icons-round">delete_outline</span>';
                    header.appendChild(btn);
                }
            });

            // 3. Prepara imagens (Wrappers Interativos)
            document.querySelectorAll('.img-container').forEach(container => {
                if (container.querySelector('.floating-toolbar')) return; // Já tem

                const img = container.querySelector('img');
                if (!img) return;

                const wrapper = document.createElement('div');
                wrapper.className = 'img-wrapper';

                const viewport = document.createElement('div');
                viewport.className = 'img-viewport';

                // Move a imagem para o viewport
                img.parentNode.insertBefore(wrapper, img);
                wrapper.appendChild(viewport);
                viewport.appendChild(img);
                img.className = 'img-screenshot';

                // Adiciona Toolbar
                const toolbar = document.createElement('div');
                toolbar.className = 'floating-toolbar admin-only';
                toolbar.innerHTML = `
                    <button class="btn-float" onclick="controlZoom(this, 0.2)"><span class="material-icons-round">add</span></button>
                    <button class="btn-float" onclick="controlZoom(this, -0.2)"><span class="material-icons-round">remove</span></button>
                    <div class="divider-vertical"></div>
                    <button class="btn-float btn-mark-float" onclick="addMarker(this)"><span class="material-icons-round">radio_button_unchecked</span> Marcação</button>
                `;
                wrapper.appendChild(toolbar);
            });
        }

        function initSystem() {
            reindexarSecoes();
            initImageInteractions();

            if (!document.body.classList.contains('mode-read-only')) {
                document.querySelectorAll('.marker').forEach(setupMarkerInteraction);

                // Sincronização em tempo real do sumário
                document.querySelectorAll('.secao-header h2').forEach(h2 => {
                    h2.addEventListener('input', () => {
                        clearTimeout(h2.reindexTimeout);
                        h2.reindexTimeout = setTimeout(reindexarSecoes, 500);
                    });
                });
            }
        }

        // --- 2. GESTÃO DE SEÇÕES ---
        function reindexarSecoes() {
            const secoes = document.querySelectorAll('.secao');
            const nav = document.querySelector('.sidebar-nav');
            if (!nav) return;

            nav.innerHTML = ''; // Limpa para reconstruir

            secoes.forEach((secao, index) => {
                const num = index + 1;
                const numEl = secao.querySelector('.secao-numero');
                if (numEl) numEl.innerText = num;

                const titulo = secao.querySelector('h2').innerText || `Seção ${num}`;

                const a = document.createElement('a');
                a.href = '#' + (secao.id || `secao-${num}`);
                if (!secao.id) secao.id = `secao-${num}`;

                a.onclick = (e) => {
                    e.preventDefault();
                    secao.scrollIntoView({ behavior: 'smooth' });
                    document.querySelectorAll('.sidebar-nav a').forEach(l => l.classList.remove('active'));
                    a.classList.add('active');
                };
                a.innerHTML = `<span style="font-weight:700; color:var(--teal-500)">${num}.</span> ${titulo}`;
                nav.appendChild(a);
            });
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('collapsed');
        }

        function toggleNavGroup(header) {
            header.parentElement.classList.toggle('collapsed');
        }

        function deletarSecao(btn) {
            if (confirm("Excluir esta seção?")) {
                btn.closest('.secao').remove();
                reindexarSecoes();
            }
        }

        function adicionarSecao() {
            const wrapper = document.querySelector('.content-wrapper');
            const newSecao = document.createElement('section');
            newSecao.className = 'secao';
            const id = 'secao-' + (document.querySelectorAll('.secao').length + 1);
            newSecao.id = id;

            newSecao.innerHTML = `
                <div class="secao-header">
                    <span class="secao-numero"></span>
                    <h2 contenteditable="true">Nova Seção</h2>
                    <button class="btn-delete-section admin-only" onclick="deletarSecao(this)"><span class="material-icons-round">delete_outline</span></button>
                </div>
                <div class="secao-conteudo">
                    <p contenteditable="true">Edite este conteúdo...</p>
                </div>
            `;
            wrapper.appendChild(newSecao);
            reindexarSecoes();
            newSecao.scrollIntoView({ behavior: 'smooth' });
        }

        // --- 3. IMAGENS & MARCADOES (RE-USADO) ---
        function controlZoom(btn, delta) {
            const wrapper = btn.closest('.img-wrapper');
            const viewport = wrapper.querySelector('.img-viewport');
            let scale = parseFloat(viewport.dataset.scale || 1) + delta;
            scale = Math.min(Math.max(1, scale), 5);

            viewport.style.transform = `scale(${scale})`;
            viewport.dataset.scale = scale;
            viewport.classList.toggle('grab', scale > 1);
        }

        function addMarker(btn) {
            const viewport = btn.closest('.img-wrapper').querySelector('.img-viewport');
            const marker = document.createElement('div');
            marker.className = 'marker';
            marker.style.top = '40%'; marker.style.left = '40%';

            marker.innerHTML = `
                <div class="marker-delete-btn" onclick="event.stopPropagation(); this.parentElement.remove()">×</div>
                <div class="marker-resize-handle"></div>
            `;

            viewport.appendChild(marker);
            setupMarkerInteraction(marker);
        }

        function setupMarkerInteraction(marker) {
            marker.onmousedown = function (e) {
                if (document.body.classList.contains('mode-read-only')) return;
                if (e.target.className.includes('handle') || e.target.className.includes('delete')) return;
                e.preventDefault(); e.stopPropagation();

                let startX = e.clientX, startY = e.clientY;
                let startL = marker.offsetLeft, startT = marker.offsetTop;

                function move(e) {
                    marker.style.left = (startL + e.clientX - startX) + 'px';
                    marker.style.top = (startT + e.clientY - startY) + 'px';
                }
                function up() { window.removeEventListener('mousemove', move); window.removeEventListener('mouseup', up); }
                window.addEventListener('mousemove', move); window.addEventListener('mouseup', up);
            };

            const handle = marker.querySelector('.marker-resize-handle');
            handle.onmousedown = function (e) {
                e.preventDefault(); e.stopPropagation();
                let startX = e.clientX, startW = marker.offsetWidth;
                function resize(e) {
                    let size = Math.max(20, startW + (e.clientX - startX));
                    marker.style.width = size + 'px'; marker.style.height = size + 'px';
                }
                function up() { window.removeEventListener('mousemove', resize); window.removeEventListener('mouseup', up); }
                window.addEventListener('mousemove', resize); window.addEventListener('mouseup', up);
            };
        }

        function initImageInteractions() {
            // Placeholder para interações complexas de pan se necessário futuramente
        }

        // --- 4. EXPORTAÇÃO ---
        function salvarAlteracoes() {
            reindexarSecoes();
            const clone = document.documentElement.cloneNode(true);
            clone.querySelector('body').classList.remove('mode-read-only');

            // Limpa estados de UI temporários do clone
            clone.querySelectorAll('.img-viewport').forEach(v => {
                v.style.transform = '';
                delete v.dataset.scale;
                v.classList.remove('grab', 'grabbing');
            });

            download('<!DOCTYPE html>\n' + clone.outerHTML, 'Manual_EFD_Contrib_Editavel.html');
        }

        function exportarHTML() {
            reindexarSecoes();
            const clone = document.documentElement.cloneNode(true);
            clone.querySelector('body').classList.add('mode-read-only');
            clone.querySelectorAll('.admin-only').forEach(el => el.remove());
            clone.querySelectorAll('[contenteditable]').forEach(el => el.removeAttribute('contenteditable'));

            download('<!DOCTYPE html>\n' + clone.outerHTML, 'Manual_EFDN_Leitura.html');
        }

        function download(content, name) {
            const a = document.createElement('a');
            const blob = new Blob([content], { type: 'text/html' });
            a.href = URL.createObjectURL(blob);
            a.download = name;
            a.click();
        }
    </script>
</body>

</html>